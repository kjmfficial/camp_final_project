from typing import Dict, List, TypedDict, Optional

L1_1 = "청약이란?"
L1_2 = "청약 통장이란?"
L1_3 = "청약 일정"
L1_4 = "나에게 가능한 청약은?"
L1_5 = "청약체험 및 연습"
L1_6 = "자주묻는질문(FAQ)"
L1_7 = "청약 통계"
L1_8 = "청약 용어집"

L2_1 = "특별공급"
L2_2 = "우선공급"
L2_3 = "일반공급"
L2_4 = "청약 신청 어디서 해?"
L2_5 = "청약 통장을 개설하고 싶어"
L2_6 = "이미 청약통장 보유중이야"
L2_7 = ""
L2_8 = "청약가상체험"
L2_9 = "공고단지 청약연습"
L2_10 = "청약이 잘 안되세요?"
L2_11 = "청약통장"
L2_12 = "청약가점제"
L2_13 = "청약 제한"
L2_14 = "분양권전매"
L2_15 = "경쟁률"
L2_16 = "분양가"

L3_1 = "신혼부부"
L3_2 = "생애최초 주택구입"
L3_3 = "기관추천"
L3_4 = "다자녀가구"
L3_5 = "노부모부양"
L3_6 = "청년"
L3_7 = "신생아"
L3_8 = "이전기관종사자"
L3_9 = "외국인"
L3_10 = "청약통장 가입"
L3_11 = "청약통장 납입금액을 바꾸고 싶어"
L3_12 = ""
L3_13 = "청약순위"
L3_14 = "청약자격/청약제한"
L3_15 = "거주지/연락처 입력"
L3_16 = "오류발생"
L3_17 = "청약 후 확인/수정"
L3_18 = "순위확인서 발급"
L3_19 = "청약통장의 가입"
L3_20 = "청약통장의 변경"
L3_21 = "청약신청"
L3_22 = "주택소유여부"
L3_23 = "주택청약 종합저축의 순위발생"
L3_24 = "무주택세대구성원"
L3_25 = "청약가점제 내용"
L3_26 = "부양가족"
L3_27 = "무주택기간"
L3_28 = "무주택기준"
L3_29 = ""
L3_30 = ""


class Button(TypedDict):
    text: str            # 버튼에 표시될 텍스트
    nextQuestion: str    # 버튼 클릭시 이동할 다음 질문

class ScenarioResponse(TypedDict):
    text: str                           # 시나리오 응답 텍스트
    buttons: Optional[List[Button]]     # 선택적으로 표시될 버튼들

# 시나리오 데이터
SCENARIOS: Dict[str, ScenarioResponse] = {
    L1_1: {
        "text": """주택청약은 새로 공급되는 주택의 분양 기회를 제공하는 제도입니다. 국가 또는 민간 건설사가 건설한 주택을 대상으로 하며, 청약통장 가입과 일정한 자격 요건을 충족한 자가 신청할 수 있습니다. 분양 주택은 크게 국민주택과 민영주택으로 구분되며, 각 유형별로 공급 대상 및 자격 요건에 차이가 있습니다.

청약 신청 시에는 일반공급, 우선공급, 특별공급으로 구분하여 진행됩니다. 각 공급 유형별로 분양 대상자 선정 기준 및 우선 순위가 다르게 적용되므로, 청약 신청자는 본인에게 유리한 공급 유형을 신중하게 선택해야 합니다.""",
        "buttons": [
            {"text": L2_1, "nextQuestion": L2_1},
            {"text": L2_2, "nextQuestion": L2_2},
            {"text": L2_3, "nextQuestion": L2_3},
            {"text": L2_4, "nextQuestion": L2_4}
        ]
    },

    L2_1:{
        "text": """특별공급은 정책적 배려가 필요한 사회계층 중 무주택자의 주택마련을 지원하기 위하여 주택 공급량의 일정비율을 특별공급 대상자에게 공급하는 제도입니다.

특별공급 대상계층은 다음과 같습니다.
신혼부부 - 혼인기간이 7년 이내인 무주택 신혼부부
생애최초 주택구입 - 생애 최초로 주택을 구입하는 자
기관추천 - 국가유공자, 독립유공자 등의 가구
다자녀가구 - 미성년인 자녀 2명을 둔 가구
노부모부양 - 만65세 이상 직계존속과 주민등록등본 상 3년 이상 함께 등재된 가구
청년 - 만19세 이상 만39세 이하 미혼 청년으로, 과거 주택을 소유한 사실이 없는 자
신생아 - 2세 미만 자녀가 있는 자
이전기관종사자 - 비수도권으로 이전하는 공공기관, 학교 등에 종사하는 자
외국인 - 시도지사가 정한 외국인 중 무주택자""",
        "buttons":[
            {"text":L3_1, "nextQuestion":L3_1},
            {"text":L3_2, "nextQuestion":L3_2},
            {"text":L3_3, "nextQuestion":L3_3},
            {"text":L3_4, "nextQuestion":L3_4},
            {"text":L3_5, "nextQuestion":L3_5},
            {"text":L3_6, "nextQuestion":L3_6},
            {"text":L3_7, "nextQuestion":L3_7},
            {"text":L3_8, "nextQuestion":L3_8},
            {"text":L3_9, "nextQuestion":L3_9}
        ]
    },

    L3_1:{
        "text":"""입주자모집공고일 현재 혼인기간이 7년 이내인 분
""",
        "buttons":[
            {"text":L1_4, "nextQuestion":L1_4}
        ]
    },

    L3_2:{
        "text":"""생애 최초(세대구성원 모두 과거 주택을 소유한 사실이 없는 경우로 한정)로 주택을 구입하는 분으로서 다음의 요건을 충족하는 분

* 투기과열지구 또는 청약과열지역의 주택에 청약 시 과거 5년 이내에 다른 주택에 당첨된 자가 속해 있는 세대에 속한 분은 청약불가

일반공급 1순위인 무주택 세대의 세대주 또는 세대구성원
아래 ① 또는 ②에 해당하는 분
① 입주자모집공고일 현재 혼인 중이거나 미혼인 자녀(임신 및 입양 포함, 신청자가 혼인 중이 아닌 경우에는 동일한 주민등록표등본에 올라 있는 자녀를 말함)가 있는 분

② 위 ①에 해당하지 않는 1인가구

* 1인가구는 추첨제로만 청약 가능

* 1인가구 중 '단독세대가 아닌 자'(주민등록표등본에 직계존속과 함께 등재된 경우)는 전 주택형에 청약 가능

* 1인가구 중 '단독세대'(주민등록표등본에 직계존속이 함께 등재되지 않은 경우)는 전용면적 60㎡ 이하 주택형에 한해 청약 가능

입주자모집공고일 현재 근로자 또는 자영업자(과거 1년 내에 소득세를 납부한 경우 포함)로서 5년 이상 소득세를 납부한 분
""",
        "buttons":[
            {"text":L1_4, "nextQuestion":L1_4}
        ]
    },

    L3_3:{
        "text":"""입주자모집공고일 현재 주택공급에관한규칙 제4조 제3항에 따른 공급대상인 무주택세대구성원(제27호의2에 해당하는 경우는 제외)으로서 관계기관의 장이 정하는 우선순위 기준에 따라 대상자로 선정된 자
공통 : 국가유공자, 독립유공자, 보훈대상자, 5.18유공자, 특수임무유공자, 참전유공자, 장기복무(제대)군인, 북한이탈주민, 납북피해자, 일본군위안부, 장애인, 영구귀국과학자, 올림픽 등 입상자, 중소기업근무자, 공공사업 등, 의사상자 등
국민주택 : 철거주택 소유자 또는 거주자(세입자), 다문화가족, 탄광근로자, 재외동포 등
민영주택 : 철거주택 소유 및 거주자, 해외취업근로자 등
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L3_4:{
        "text":"""입주자모집공고일 현재 미성년인 자녀 2명 이상을 둔 자(태아, 입양자녀 포함)
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L3_5:{
        "text":"""일반공급 1순위에 해당하는 자로서 만65세 이상의 직계존속(배우자의 직계존속 포함)을 3년 이상 계속하여 부양(같은 세대별 주민등록표등본에 등재)하고 있는 세대주

* 노부모부양 특별공급은 무주택세대주만이 신청할 수 있음 (세대구성원은 청약 불가)

** 투기과열지구 또는 청약과열지역의 주택에 청약 시 과거 5년 이내에 다른 주택에 당첨된 자가 속해 있는 세대에 속한 자는 청약불가
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L3_6:{
        "text":"""입주자모집공고일 현재 청년(만19세 이상 만39세 이하로 혼인 중이 아니며, 과거 주택을 소유한 사실이 없는 사람)인 자
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L3_7:{
        "text":"""입주자모집공고일 현재 2세 미만(2세가 되는 날을 포함)의 자녀가 있는 분
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L3_8:{
        "text":"""입주자모집공고일 현재 해당기관 종사자로서 해당기관에서 ‘주택 특별공급대상자 확인서’를 발급받은 분
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L3_9:{
        "text":"""입주자모집공고일 현재 시도지사가 정한 외국인 중 무주택자
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L2_2:{
        "text":"""우선공급은 일반공급 대상자와 경쟁하되, 특정 자격 요건을 갖춘 신청자에게 우선적인 분양 기회를 부여하는 제도입니다. 주로 해당 주택 건설 지역의 원주민, 임대사업자 등과 같이 주택 마련에 대한 필요성이 더욱 큰 경우에 적용됩니다.

행정구역 개편이나 도시 개발 등으로 인해 주거 환경이 변화된 지역 주민들의 주거 안정을 도모하고, 임대 사업 활성화를 지원하기 위한 정책적 목적을 가지고 있습니다.
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L2_3:{
        "text":"""일반공급은 특별공급이나 우선공급 대상에 해당하지 않는 일반적인 청약 신청자를 위한 공급 방식입니다. 청약통장 가입 등 일정한 자격 요건만 충족하면 누구나 신청할 수 있으나, 다양한 신청자가 경쟁하기 때문에 당첨 경쟁률이 높은 편입니다.
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L2_4:{
        "text":"""청약홈 : https://www.applyhome.co.kr/co/coa/selectMainView.do

LH청약 플러스 : https://apply.lh.or.kr/lhapply/main.do

청약은 청약홈, LH 청약 플러스 또는 각 지자체 청약사이트를 검색해 신청할 수 있습니다.
""",
        "buttons":[
            {"text":L1_4, "nextQuestion":L1_4}
        ]
    },

    L1_2:{
        "text":"""청약통장은 새로 건설되는 아파트의 분양을 신청하기 위해 필요한 저축 상품입니다.
청약통장은 다음과 같이 나뉩니다.
주택청약종합저축 - 국민주택 및 민영주택을 공급받기 위해 가입하는 저축상품
청년주택드림 청약통장 - 청년들(만19세 ~ 만34세)의 주택 구입과 자산 형성을 지원하기 위한 특별한 청약통장

2015년 이후, 청약저축, 청약부금, 청약예금은 주택청약종합저툭으로 상품이 통합되어 가입이 종료된 상태입니다.
""",
        "buttons":[
            {"text":L2_5, "nextQuestion":L2_5},
            {"text":L2_6, "nextQuestion":L2_6}
        ]
    },

    L2_5:{
        "text":"""00님은 청년주택드림 청약통장 가입 대상이예요.
인터넷 가입을 위해서는 본인 인증을 위한 신분증 등이 필요해요.
""",
        "buttons":[
            {"text":L3_10, "nextQuestion":L3_10}
        ]
    },

    L3_10:{
        "text":"""가입URL
(은행어플과 연동시 사용가능)
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L2_6:{
        "text":"""이미 청약통장을 보유하고 계시군요!
00님께 알맞는 청약 정보를 확인하시겠습니까?
""",
        "buttons":[
            {"text":L1_4, "nextQuestion":L1_4},
            {"text":L3_11, "nextQuestion":L3_11}
        ]
    },

    L3_11:{
        "text":"""변경 신청 URL
(은행어플과 연동시 사용가능)
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L1_4:{
        "text":"""맞춤 청약 정보를 확인하기 위해서는 추가적인 개인정보 입력이 필요해요.

정보를 받는데 약 5분정도 소요됩니다.
""",
        "buttons":[
            {"text":"추가 정보 입력하러 가기", "nextQuestion":"추가 정보 입력하러 가기"}
        ]
    },

    L1_5:{
        "text":"""청약체험 및 연습을 통해 청약 신청에 실수가 없도록 대비해보세요
 청약가상체험으로 전반적인 청약 절차를 익힌 후 공고단지 청약연습을 통해 실전대비하는 것을 추천드려요
공고단지 청약연습 이용시간 (09:00 ~ 17:30)
""",
        "buttons":[
            {"text":L2_8, "nextQuestion":L2_8},
            {"text":L2_9, "nextQuestion":L2_9}
        ]
    },

    L2_8:{
        "text":"""청약홈에서 실제 청약 신청을 대비하여 체험해볼 수 있습니다.
https://www.applyhome.co.kr/ap/app/reqst/selectSubscrtReqstAptMainView.do
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

    L2_9:{
        "text":"""공고단지 청약연습은 현재 모집공고 중인 단지의 정보로 실전과 같은 형태로 연습해볼 수 있습니다.
https://www.applyhome.co.kr/ap/apr/reqst/selectSubscrtReqstAptMainView.do
""",
        "buttons":[{"text":"다른질문하기", "nextQuestion":"다른질문하기"}]
    },

# FAQ

    L1_6:{
        "text":"""
""",
        "buttons":[
            {"text":L2_10, "nextQuestion":L2_10},
            {"text":L2_11, "nextQuestion":L2_11},
            {"text":L2_12, "nextQuestion":L2_12},
            {"text":L2_13, "nextQuestion":L2_13},
            {"text":L2_14, "nextQuestion":L2_14}
        ]
    },

    L2_10:{
        "text":"""
""",
        "buttons":[
            {"text":L3_13, "nextQuestion":L3_13},
            {"text":L3_14, "nextQuestion":L3_14},
            {"text":L3_15, "nextQuestion":L3_15},
            {"text":L3_16, "nextQuestion":L3_16},
            {"text":L3_17, "nextQuestion":L3_17},
            {"text":L3_18, "nextQuestion":L3_18}
        ]
    },

    L2_11:{
        "text":"""
""",
        "buttons":[
            {"text":L3_19, "nextQuestion":L3_19},
            {"text":L3_20, "nextQuestion":L3_20},
            {"text":L3_21, "nextQuestion":L3_21},
            {"text":L3_22, "nextQuestion":L3_22},
            {"text":L3_23, "nextQuestion":L3_23},
            {"text":L3_24, "nextQuestion":L3_24}
        ]
    },

    L2_12:{
        "text":"""
""",
        "buttons":[
            {"text":L3_25, "nextQuestion":L3_25},
            {"text":L3_26, "nextQuestion":L3_26},
            {"text":L3_27, "nextQuestion":L3_27},
            {"text":L3_28, "nextQuestion":L3_28},
        ]
    },

    "다른질문하기":{
        "text":"""안녕하세요, 청약 도우미 청약이입니다. 무엇을 도와드릴까요?
""",
        "buttons":[
            {"text":L1_1, "nextQuestion":L1_1},
            {"text":L1_2, "nextQuestion":L1_2},
            {"text":L1_3, "nextQuestion":L1_3},
            {"text":L1_4, "nextQuestion":L1_4}
        ]
    }
    
}

def get_scenario_response(question: str) -> Optional[ScenarioResponse]:
    """질문에 해당하는 시나리오 응답을 반환합니다."""
    return SCENARIOS.get(question)
